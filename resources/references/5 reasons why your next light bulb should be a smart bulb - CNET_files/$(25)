;/*7P1RCD3H9R0M*/var I10C;var I11C;(function(I10C){ I10C.ScriptBegin || (I10C.ScriptBegin = function(){}); I10C.ScriptEnd || (I10C.ScriptEnd = function(){});I10C.PostMessage || (I10C.PostMessage = function(){ return this.postMessage.apply(this, arguments); });I10C.Location || (I10C.Location = function i10cloc(ba$e, isWrite, op){ var locat1onPresent = Object.getOwnPropertyNames(ba$e).indexOf('locat1on') !== -1; return (!isWrite) ? ( locat1onPresent ? ba$e.locat1on : (ba$e.location || ba$e.locat1on)) : (locat1onPresent ? {set href(v) {ba$e.locat1on.href = v;}, get href() {return i10cloc(ba$e,false,op);}} : {set href(v) {ba$e.location = v;}, get href() {return i10cloc(ba$e,false,op);}});});
I11C.PreLocationContextProxy || (I11C.PreLocationContextProxy = function i10cPreLocContext(ba$e) { return ba$e;});})(I11C||I10C|| (I11C = {}));(I11C || I10C).ScriptBegin();define(["jquery","version!fly/managers/debug","managers/user"],function(t,e,n){e=e.init("myListsCount"),t.widget("cnet.myListsCount",t.fly.base,{options:{countUrl:"/userlist/count/",listId:"",buttonClass:".myListButton"},_create:function(){this._super("_create"),e.log("_create"),this._setupEvents()},_setupEvents:function(){var e=this;e._updateCount(),t(e.options.buttonClass).on({myListCountUpdate:function(){e._updateCount()}})},_updateCount:function(){var s=this,o=s.options;n.getUserData(function(n,i){if(i.isLoggedIn){e.log("logged in, check list count",s.element);var u={regId:i.registrationId,listId:o.listId};t.ajax({type:"GET",dataType:"json",url:o.countUrl,data:u,cache:!1}).done(function(t){"success"==t.status?(e.log("Count update success",t.count,s.$element),s.$element.attr("data-count",t.count),s.$element.html(t.count),e.log("show giftListWrap"),s.$element.closest(".giftListWrap").css("visibility","visible")):e.log("Count update failed")}).error(function(){e.log("Count update failed, ajax error")})}else e.log("Count is 0, not logged in")})}})});
;(I11C || I10C).ScriptEnd();